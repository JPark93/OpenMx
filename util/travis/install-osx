#!/bin/bash

set -ve

cp ./util/gcc.conf ~/.R/Makevars

xcodebuild -version | head -n 1 | cut -d ' ' -f 2

# for macos 10.11 :

curl -Lo /tmp/gcc.tar.gz 'http://prdownloads.sourceforge.net/hpc/gcc-5.3-bin.tar.gz?download'
curl -Lo /tmp/gfort.tar.gz 'http://prdownloads.sourceforge.net/hpc/gfortran-5.3-bin.tar.gz?download'

sudo rm -rf /usr/local/lib/gcc
sudo rm -rf /usr/local/include/c++

sudo tar -zxvf /tmp/gcc.tar.gz -C /
sudo tar -zxvf /tmp/gfort.tar.gz -C /

curl -L https://github.com/Unidata/netcdf-c/archive/v4.6.0.tar.gz | tar -C /tmp --extract --gunzip --file -
(cd /tmp/netcdf-c-4.6.0/ && ./configure --disable-netcdf-4 && sudo make install)

curl -L https://github.com/Unidata/netcdf-cxx4/archive/v4.3.0.tar.gz | tar -C /tmp --extract --gunzip --file -
(cd /tmp/netcdf-cxx4-4.3.0 && ./configure && sudo make install)

R --no-save -f util/update-dependencies.R --args ./DESCRIPTION.in

which otool
